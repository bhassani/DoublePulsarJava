[![License: GPL v3](https://img.shields.io/badge/License-GPLv3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0)
# DoublePulsarJava
Repository for DoublePulsar DLL/Shellcode uploader programs<br />

## Project accomplishments
- DoublePulsar Upload Shellcode - completed and working, inject your shellcode into any process you desire

## Project goals
- Fix bugs
- More testing
- GUI
- Upload Shellcode
- Upload DLL
- Upload Exe inside a DLL

## Demo
* **Doublepulsar_UploadShellcode** - This program sends 5 SMB packets.  1 negotiation, 1 session setup, 1 tree connect, 1 Ping Trans2 SESSION_SETUP packet and 1 execute Trans2 SESSION_SETUP packet.  The Trans2 SESSION SETUP request packet is sent to obtain the SMB signature in the TRANS2 SESSION_SETUP response packet. This signature is processed through the DoublePulsar XOR key calculator.  The program then copies kernel shellcode and sample shellcode from a buffer, it XORs the buffer with the DoublePulsar XOR key we calculated from the SMB signature.  A packet is generated by allocating memory, copying the Trans2 exec packet (from Wannacry), edits the values needed for the SMB transaction to work ( UserID, TreeID, TotalDataCount, DataCount, ByteCount ) then copying the SESSION_SETUP Parameters and 4096 bytes of XORed shellcode data (the encrypted shellcode) to the end and send it at a total packet length of 4178 bytes to DoublePulsar.  Total packet length = 4178.  NetBIOS length will be 4174 since the NetBIOS header does NOT count itself for the size.  12 bytes of this packet is for the Doublepulsar SESSION_PARAMETERS.  4096 is for the XORed encrypted data.  Will also implement using SMB & TRANSACTION2 structure.<br /><br/><br />
Doublepulsar UploadShellcode that sends pop notepad shellcode that runs notepad with SYSTEM privileges:<br />
![UploadShellcodeJava](/images/UploadShellcodeJava.png)
